{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Drive/Web/jason_web/proxy.ts"],"sourcesContent":["// proxy.ts\nimport { NextResponse, type NextRequest } from \"next/server\";\n\nexport const config = {\n  matcher: [\"/((?!_next/|favicon.ico|robots.txt|sitemap.xml).*)\"],\n};\n\nfunction parsePairs(env: string | undefined) {\n  return (env || \"\")\n    .split(\",\")\n    .map((s) => s.trim())\n    .filter(Boolean); // e.g., [\"you:pass\", \"visitor:pass\"]\n}\n\nexport function proxy(req: NextRequest) {\n  const pairs =\n    parsePairs(process.env.BASIC_AUTH_PAIRS).length\n      ? parsePairs(process.env.BASIC_AUTH_PAIRS)\n      : [\n          `${process.env.BASIC_AUTH_USER || \"\"}:${\n            process.env.BASIC_AUTH_PASS || \"\"\n          }`,\n        ];\n\n  const auth = req.headers.get(\"authorization\") || \"\";\n  if (auth.startsWith(\"Basic \")) {\n    const decoded = Buffer.from(auth.slice(6), \"base64\").toString(\"utf8\"); // \"user:pass\"\n    if (pairs.includes(decoded)) {\n      return NextResponse.next();\n    }\n  }\n\n  return new NextResponse(\"Auth required\", {\n    status: 401,\n    headers: { \"WWW-Authenticate\": 'Basic realm=\"Gallery\"' },\n  });\n}"],"names":[],"mappings":"AAAA,WAAW;;;;;;;AACX;;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAqD;AACjE;AAEA,SAAS,WAAW,GAAuB;IACzC,OAAO,CAAC,OAAO,EAAE,EACd,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI,IACjB,MAAM,CAAC,UAAU,qCAAqC;AAC3D;AAEO,SAAS,MAAM,GAAgB;IACpC,MAAM,QACJ,WAAW,QAAQ,GAAG,CAAC,gBAAgB,EAAE,MAAM,GAC3C,WAAW,QAAQ,GAAG,CAAC,gBAAgB,IACvC;QACE,GAAG,QAAQ,GAAG,CAAC,eAAe,IAAI,GAAG,CAAC,EACpC,QAAQ,GAAG,CAAC,eAAe,IAAI,IAC/B;KACH;IAEP,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACjD,IAAI,KAAK,UAAU,CAAC,WAAW;QAC7B,MAAM,UAAU,OAAO,IAAI,CAAC,KAAK,KAAK,CAAC,IAAI,UAAU,QAAQ,CAAC,SAAS,cAAc;QACrF,IAAI,MAAM,QAAQ,CAAC,UAAU;YAC3B,OAAO,8IAAY,CAAC,IAAI;QAC1B;IACF;IAEA,OAAO,IAAI,8IAAY,CAAC,iBAAiB;QACvC,QAAQ;QACR,SAAS;YAAE,oBAAoB;QAAwB;IACzD;AACF","debugId":null}}]
}